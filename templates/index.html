<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Study Note Generator</title>
    
    <!-- Bootstrap 5 -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    
    <!-- Font Awesome -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    
    <!-- Custom CSS -->
    <link href="{{ url_for('static', filename='css/style.css') }}" rel="stylesheet">
</head>
<body>
    <div class="container container-main py-4">
        <!-- Header -->
        <header class="text-center mb-5">
            <h1 class="display-4 fw-bold text-white mb-3">
                <i class="fas fa-robot me-3"></i>AI Study Note Generator
            </h1>
            <p class="lead text-white-50">
                Upload university slides → Get detailed LaTeX notes and questions
            </p>
        </header>

        <!-- Main Card -->
        <div class="card p-4 p-md-5">
            <!-- Upload Section -->
            <div class="mb-5">
                <h3 class="mb-4">
                    <i class="fas fa-cloud-upload-alt me-2"></i>Upload PDF Slides
                </h3>
                
                <div id="uploadArea" class="upload-area">
                    <i class="fas fa-file-pdf fa-4x mb-4" style="color: #667eea;"></i>
                    <h4 class="mb-3">Drag & Drop Your PDF Here</h4>
                    <p class="text-muted mb-4">or click to browse (text-based PDFs only)</p>
                    <input type="file" id="fileInput" class="d-none" accept=".pdf">
                    <button class="btn btn-outline-primary btn-lg" onclick="document.getElementById('fileInput').click()">
                        <i class="fas fa-folder-open me-2"></i>Choose PDF File
                    </button>
                </div>
                
                <!-- File Info -->
                <div id="fileInfo" class="file-info d-none">
                    <div class="file-info-item">
                        <span>Selected File:</span>
                        <strong id="fileName">-</strong>
                    </div>
                    <div class="file-info-item">
                        <span>File Size:</span>
                        <span id="fileSize">-</span>
                    </div>
                    <div class="progress-container mt-3">
                        <div id="progressBar" class="progress-bar"></div>
                    </div>
                </div>
            </div>

            <!-- Processing Options -->
            <div class="row mb-5">
                <div class="col-md-6 mb-3">
                    <label class="form-label fw-bold">
                        <i class="fas fa-sticky-note me-2"></i>Note Style
                    </label>
                    <select id="noteType" class="form-select">
                        <option value="detailed">Detailed Notes + Questions</option>
                        <option value="concise">Concise Summary</option>
                        <option value="outline">Structured Outline</option>
                    </select>
                </div>
                
                <div class="col-md-6 mb-3">
                    <label class="form-label fw-bold">
                        <i class="fas fa-cog me-2"></i>Processing Options
                    </label>
                    <div class="form-check mb-2">
                        <input class="form-check-input" type="checkbox" id="includeQuestions" checked>
                        <label class="form-check-label" for="includeQuestions">
                            Include Comprehension Questions
                        </label>
                    </div>
                    <div class="form-check mb-2">
                        <input class="form-check-input" type="checkbox" id="compileDirectly" disabled>
                        <label class="form-check-label" for="compileDirectly">
                            Compile directly to PDF <span class="badge bg-info">Requires LaTeX</span>
                        </label>
                    </div>
                    <div class="form-check">
                        <input class="form-check-input" type="checkbox" id="useOverleaf">
                        <label class="form-check-label" for="useOverleaf">
                            Auto-upload to Overleaf <span class="badge bg-success">Professional PDF</span>
                        </label>
                    </div>
                </div>
            </div>

            <!-- Status & Actions -->
            <div class="row mb-4">
                <div class="col-md-6 mb-3">
                    <div class="d-flex align-items-center">
                        <span class="me-3 fw-bold">System Status:</span>
                        <span id="apiStatus" class="status-badge status-processing">Checking...</span>
                    </div>
                </div>
                <div class="col-md-6 mb-3 text-md-end">
                    <button id="processBtn" class="btn btn-primary btn-lg px-5" disabled>
                        <i class="fas fa-magic me-2"></i>Generate Study Notes
                    </button>
                </div>
            </div>

            <!-- Loading Indicator -->
            <div id="loading" class="text-center py-5 d-none">
                <div class="spinner mx-auto mb-4"></div>
                <h4>Processing Your PDF</h4>
                <p class="text-muted">Extracting text, generating notes, and formatting LaTeX...</p>
                <div class="progress-container mt-4 mx-auto" style="max-width: 300px;">
                    <div id="progressBar" class="progress-bar"></div>
                </div>
            </div>

            <!-- Results Section -->
            <div id="results" class="d-none">
                <h3 class="mb-4">
                    <i class="fas fa-file-alt me-2"></i>Generated Output
                </h3>
                
                <!-- Preview -->
                <div class="mb-4">
                    <h5>LaTeX Preview:</h5>
                    <div class="preview-box mb-3">
                        <pre id="previewContent"></pre>
                    </div>
                </div>
                
                <!-- Download Options -->
                <div class="d-flex flex-wrap gap-3 mb-4">
                    <a id="downloadLatexBtn" href="#" class="btn btn-success">
                        <i class="fas fa-download me-2"></i>Download LaTeX
                    </a>
                    <a id="downloadPdfBtn" href="#" class="btn btn-danger d-none">
                        <i class="fas fa-file-pdf me-2"></i>Download PDF
                    </a>
                    <button id="compileBtn" class="btn btn-warning">
                        <i class="fas fa-cogs me-2"></i>Compile to PDF
                    </button>
                    <button class="btn btn-outline-secondary" onclick="copyToClipboard()">
                        <i class="fas fa-copy me-2"></i>Copy Code
                    </button>
                </div>
            </div>

            <!-- Status Messages -->
            <div id="status" class="alert d-none" role="alert"></div>

            <!-- Instructions -->
            <div class="mt-5 pt-4 border-top">
                <h4 class="mb-4">
                    <i class="fas fa-info-circle me-2"></i>How It Works
                </h4>
                
                <div class="row">
                    <div class="col-md-3 mb-3">
                        <div class="text-center p-3 bg-light rounded">
                            <i class="fas fa-upload fa-2x mb-3 text-primary"></i>
                            <h5>1. Upload PDF</h5>
                            <p class="text-muted small">Upload your university lecture slides</p>
                        </div>
                    </div>
                    
                    <div class="col-md-3 mb-3">
                        <div class="text-center p-3 bg-light rounded">
                            <i class="fas fa-brain fa-2x mb-3 text-primary"></i>
                            <h5>2. AI Analysis</h5>
                            <p class="text-muted small">AI extracts key concepts and generates questions</p>
                        </div>
                    </div>
                    
                    <div class="col-md-3 mb-3">
                        <div class="text-center p-3 bg-light rounded">
                            <i class="fas fa-code fa-2x mb-3 text-primary"></i>
                            <h5>3. LaTeX Generation</h5>
                            <p class="text-muted small">Formats output as professional LaTeX code</p>
                        </div>
                    </div>
                    
                    <div class="col-md-3 mb-3">
                        <div class="text-center p-3 bg-light rounded">
                            <i class="fas fa-file-download fa-2x mb-3 text-primary"></i>
                            <h5>4. Download</h5>
                            <p class="text-muted small">Get LaTeX file or compiled PDF</p>
                        </div>
                    </div>
                </div>
                
                <div class="alert alert-info mt-4">
                    <strong><i class="fas fa-lightbulb me-2"></i>Tip:</strong> 
                    For PDF compilation, you need LaTeX installed locally (TeX Live or MiKTeX). 
                    Alternatively, upload the .tex file to <a href="https://www.overleaf.com" target="_blank">Overleaf</a>.
                </div>
            </div>
        </div>
        
        <!-- Footer -->
        <footer class="text-center text-white mt-4 py-3">
            <p class="mb-0">
                AI Study Note Generator • Built with Flask & Gemini AI •
                <a href="https://github.com/yourusername/study-note-generator" class="text-white-50">View on GitHub</a>
            </p>
        </footer>
    </div>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    
    <!-- Custom JS -->
    <script src="{{ url_for('static', filename='js/main.js') }}"></script>
    
    <!-- Utility Functions -->
    <script>
        function copyToClipboard() {
            const text = document.getElementById('previewContent').textContent;
            navigator.clipboard.writeText(text).then(() => {
                const alert = document.createElement('div');
                alert.className = 'alert alert-success alert-dismissible fade show position-fixed top-0 end-0 m-3';
                alert.style.zIndex = '9999';
                alert.innerHTML = `
                    <i class="fas fa-check-circle me-2"></i>
                    Code copied to clipboard!
                    <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
                `;
                document.body.appendChild(alert);
                
                setTimeout(() => alert.remove(), 3000);
            });
        }
        
        // Auto-refresh health check every 30 seconds
        setInterval(() => {
            if (window.app) {
                window.app.checkHealth();
            }
        }, 30000);
    </script>
</body>
</html>